
---
title: "Example of reading simulations from behaviorspace"
author: "Leonardo A. Saravia"
date: "21/5/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)

needed_packages <- c(
    "tidyverse"
  , "lubridate")

lapply(needed_packages, function(x) { if(!require(x,character.only = TRUE)) install.packages(x)} )

theme_set(theme_bw())

```

# Run and Read simulations from behaviorspace (headless)

```{r read_behav, echo=FALSE, tidy=TRUE, message=FALSE, warning=FALSE, eval=FALSE}

# Probably not work outside linux
#
system("bash netlogo-headless-exp.sh")

simul_fn <- list.files(path="Simulations",pattern="^Visits.*csv")

# Read all simulations in simul_fn
#
mdl <- lapply( simul_fn, function(x){ read_delim(paste0("Simulations/",x),";") })

mdl <- bind_rows(mdl)

# Correct names
#
names(mdl) <- str_trim(names(mdl))

# sp 1 fligth_speed: 1.3 max_distance: 143.3"
# sp 2 fligth_speed: 2.2 max_distance: 562.2"
# sp 3 fligth_speed: 1.7 max_distance: 358.8"
# sp 4 fligth_speed: 2.6 max_distance: 783.9"
# sp 5 fligth_speed: 1.4 max_distance: 170.4"
# sp 6 fligth_speed: 2.4 max_distance: 682.3"

mdl %>% group_by(pollinator_species) %>% summarize(foraging_distance = max(foraging_distance) ) %>% mutate(flight_speed= "add1")
tt <- bind_rows(tt, mdl %>% group_by(pollinator_species) %>% summarize(foraging_distance = mean(foraging_distance) ) %>% mutate(flight_speed= "add1"))


```

